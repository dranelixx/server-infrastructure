# Systemd hardening override for GitHub Actions Runner
# Deployed as drop-in: /etc/systemd/system/<service>.d/hardening.conf

[Service]
# Filesystem protection
NoNewPrivileges=true
PrivateTmp=true
PrivateDevices=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths={{ github_runner_home }} {{ github_runner_work_dir }}

# Kernel protection
ProtectKernelTunables=true
ProtectKernelModules=true
ProtectKernelLogs=true
ProtectControlGroups=true
ProtectClock=true
ProtectHostname=true

# Capabilities and restrictions
CapabilityBoundingSet=
RestrictRealtime=true
RestrictSUIDSGID=true
LockPersonality=true
RemoveIPC=true
SystemCallArchitectures=native

# Environment
Environment="RUNNER_ALLOW_RUNASROOT=0"
